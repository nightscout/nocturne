// AUTO-GENERATED - DO NOT EDIT
// Generated by @nocturne/remote-function-codegen
// Source: openapi.json

import { getRequestEvent, query, command } from '$app/server';
import { error } from '@sveltejs/kit';
import { z } from 'zod';
import { CarbIntakeSchema } from '$lib/api/generated/schemas';
import { type CarbIntake } from '$api';

/** Get carb intakes with optional filtering */
export const getCarbIntakes = query(z.object({ from: z.number().optional(), to: z.number().optional(), limit: z.number().optional(), offset: z.number().optional(), sort: z.string().optional(), device: z.string().optional(), source: z.string().optional() }).optional(), async (params) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.nutrition.getCarbIntakes(params?.from, params?.to, params?.limit, params?.offset, params?.sort, params?.device, params?.source);
  } catch (err) {
    console.error('Error in nutrition.getCarbIntakes:', err);
    throw error(500, 'Failed to get carb intakes');
  }
});

/** Create a new carb intake */
export const createCarbIntake = command(CarbIntakeSchema, async (request) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    const result = await apiClient.nutrition.createCarbIntake(request as CarbIntake);
    await Promise.all([
      getCarbIntakes(undefined).refresh()
    ]);
    return result;
  } catch (err) {
    console.error('Error in nutrition.createCarbIntake:', err);
    throw error(500, 'Failed to create carb intake');
  }
});

/** Get a carb intake by ID */
export const getCarbIntakeById = query(z.string(), async (id) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.nutrition.getCarbIntakeById(id);
  } catch (err) {
    console.error('Error in nutrition.getCarbIntakeById:', err);
    throw error(500, 'Failed to get carb intake by id');
  }
});

/** Update an existing carb intake */
export const updateCarbIntake = command(z.object({ id: z.string(), request: CarbIntakeSchema }), async ({ id, request }) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    const result = await apiClient.nutrition.updateCarbIntake(id, request as CarbIntake);
    await Promise.all([
      getCarbIntakes(undefined).refresh(),
      getCarbIntakeById(id).refresh()
    ]);
    return result;
  } catch (err) {
    console.error('Error in nutrition.updateCarbIntake:', err);
    throw error(500, 'Failed to update carb intake');
  }
});

/** Delete a carb intake */
export const deleteCarbIntake = command(z.string(), async (id) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    await apiClient.nutrition.deleteCarbIntake(id);
    await Promise.all([
      getCarbIntakes(undefined).refresh()
    ]);
    return { success: true };
  } catch (err) {
    console.error('Error in nutrition.deleteCarbIntake:', err);
    throw error(500, 'Failed to delete carb intake');
  }
});
