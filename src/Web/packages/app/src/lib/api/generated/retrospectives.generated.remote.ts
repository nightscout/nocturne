// AUTO-GENERATED - DO NOT EDIT
// Generated by @nocturne/remote-function-codegen
// Source: openapi.json

import { getRequestEvent, query } from '$app/server';
import { error } from '@sveltejs/kit';
import { z } from 'zod';

/** Get retrospective data at a specific point in time
Returns IOB, COB, glucose, basal rate, and recent treatments */
export const getRetrospectiveData = query(z.object({ time: z.number().optional() }).optional(), async (params) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.retrospective.getRetrospectiveData(params?.time);
  } catch (err) {
    console.error('Error in retrospective.getRetrospectiveData:', err);
    throw error(500, 'Failed to get retrospective data');
  }
});

/** Get retrospective data for an entire day at specified interval
Returns IOB, COB, glucose, and basal data for every interval throughout the day */
export const getRetrospectiveTimeline = query(z.object({ date: z.string().optional(), intervalMinutes: z.number().optional() }).optional(), async (params) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.retrospective.getRetrospectiveTimeline(params?.date, params?.intervalMinutes);
  } catch (err) {
    console.error('Error in retrospective.getRetrospectiveTimeline:', err);
    throw error(500, 'Failed to get retrospective timeline');
  }
});

/** Get basal rate timeline for a day
Returns basal rate data points showing scheduled and temp basal changes */
export const getBasalTimeline = query(z.object({ date: z.string().optional(), intervalMinutes: z.number().optional() }).optional(), async (params) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.retrospective.getBasalTimeline(params?.date, params?.intervalMinutes);
  } catch (err) {
    console.error('Error in retrospective.getBasalTimeline:', err);
    throw error(500, 'Failed to get basal timeline');
  }
});
