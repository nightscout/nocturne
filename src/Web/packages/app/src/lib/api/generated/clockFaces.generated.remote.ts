// AUTO-GENERATED - DO NOT EDIT
// Generated by @nocturne/remote-function-codegen
// Source: openapi.json

import { getRequestEvent, query, command } from '$app/server';
import { error, redirect } from '@sveltejs/kit';
import { z } from 'zod';
import { UpdateClockFaceRequestSchema, CreateClockFaceRequestSchema } from '$lib/api/generated/schemas';
import { type UpdateClockFaceRequest, type CreateClockFaceRequest } from '$api';

/** Get a clock face configuration by ID (public, no authentication required) */
export const getById = query(z.string(), async (id) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.clockFaces.getById(id);
  } catch (err) {
    const status = (err as any)?.status;
    if (status === 401) { const { url } = getRequestEvent(); throw redirect(302, `/login?redirectTo=${encodeURIComponent(url.pathname + url.search)}`); }
    if (status === 403) throw error(403, 'Forbidden');
    console.error('Error in clockFaces.getById:', err);
    throw error(500, 'Failed to get by id');
  }
});

/** Update an existing clock face (owner only) */
export const update = command(z.object({ id: z.string(), request: UpdateClockFaceRequestSchema }), async ({ id, request }) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    const result = await apiClient.clockFaces.update(id, request as UpdateClockFaceRequest);
    await Promise.all([
      list(undefined).refresh(),
      getById(id).refresh()
    ]);
    return result;
  } catch (err) {
    const status = (err as any)?.status;
    if (status === 401) { const { url } = getRequestEvent(); throw redirect(302, `/login?redirectTo=${encodeURIComponent(url.pathname + url.search)}`); }
    if (status === 403) throw error(403, 'Forbidden');
    console.error('Error in clockFaces.update:', err);
    throw error(500, 'Failed to update');
  }
});

/** Delete a clock face (owner only) */
export const remove = command(z.string(), async (id) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    await apiClient.clockFaces.delete(id);
    await Promise.all([
      list(undefined).refresh()
    ]);
    return { success: true };
  } catch (err) {
    const status = (err as any)?.status;
    if (status === 401) { const { url } = getRequestEvent(); throw redirect(302, `/login?redirectTo=${encodeURIComponent(url.pathname + url.search)}`); }
    if (status === 403) throw error(403, 'Forbidden');
    console.error('Error in clockFaces.delete:', err);
    throw error(500, 'Failed to remove');
  }
});

/** List all clock faces for the current user */
export const list = query(async () => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    return await apiClient.clockFaces.list();
  } catch (err) {
    const status = (err as any)?.status;
    if (status === 401) { const { url } = getRequestEvent(); throw redirect(302, `/login?redirectTo=${encodeURIComponent(url.pathname + url.search)}`); }
    if (status === 403) throw error(403, 'Forbidden');
    console.error('Error in clockFaces.list:', err);
    throw error(500, 'Failed to list');
  }
});

/** Create a new clock face */
export const create = command(CreateClockFaceRequestSchema, async (request) => {
  const { locals } = getRequestEvent();
  const { apiClient } = locals;
  try {
    const result = await apiClient.clockFaces.create(request as CreateClockFaceRequest);
    await Promise.all([
      list(undefined).refresh()
    ]);
    return result;
  } catch (err) {
    const status = (err as any)?.status;
    if (status === 401) { const { url } = getRequestEvent(); throw redirect(302, `/login?redirectTo=${encodeURIComponent(url.pathname + url.search)}`); }
    if (status === 403) throw error(403, 'Forbidden');
    console.error('Error in clockFaces.create:', err);
    throw error(500, 'Failed to create');
  }
});
